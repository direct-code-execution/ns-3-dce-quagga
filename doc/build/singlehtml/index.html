

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>NS3 DCE Quagga documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="None" href="index.html#document-index" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">NS3 DCE Quagga  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-ns3-dce-quagga">
<h1>Welcome to NS3 DCE Quagga<a class="headerlink" href="#welcome-to-ns3-dce-quagga" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-getting-started"></span><div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Quagga support on DCE enables the users to reuse routing protocol
implementations of Quagga (RIPv1, RIPv2, RIPng, OSPFv2, OSPFv3, BGP,
BGP+, RAadv) as models of network simulation. It reduces the time of
re-implementation of the model, and potentially improve the result of
the simulation since it already &#8220;actively running&#8221; in the real world.</p>
<p>It was started as a Google Summer of Code (GSoC) 2008 by Liu Jian with
numerous contributions especially on the netlink implementation with
quagga porting into ns-3-simu (former name of ns-3-dce). You can look
at his effort at the <a class="reference external" href="https://www.nsnam.org/wiki/index.php/Real_World_Application_Integration">link</a>.</p>
<div class="section" id="current-status-2012-4-23">
<h3>Current Status (2012/4/23)<a class="headerlink" href="#current-status-2012-4-23" title="Permalink to this headline">¶</a></h3>
<p>Quagga support on DCE does not fully support all the environment that
DCE has. The following shows the limited availability of each
protocol.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="22%" />
<col width="23%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">Basic Mode
(ns-3 stack)</th>
<th class="head">Advanced Mode
(ns-3-linux)</th>
<th class="head">Remarks</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Rtadvd (zebra)</td>
<td>NG</td>
<td>OK</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>RIPv1/v2 (ripd)</td>
<td>NG</td>
<td>OK</td>
<td>bind() fail</td>
</tr>
<tr class="row-even"><td>RIPng  (ripngd)</td>
<td>NG</td>
<td>OK</td>
<td>send() fail</td>
</tr>
<tr class="row-odd"><td>OSPFv2  (ospfd)</td>
<td>OK</td>
<td>OK</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>OSPFv3 (ospf6d)</td>
<td>NG</td>
<td>OK</td>
<td>send() fail</td>
</tr>
<tr class="row-odd"><td>BGP  (bgpd)</td>
<td>OK</td>
<td>OK</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>BGP+ (bgpd)</td>
<td>NG</td>
<td>OK</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisite">
<h3>Prerequisite<a class="headerlink" href="#prerequisite" title="Permalink to this headline">¶</a></h3>
<p>Quagga support on DCE requires several packages:
autoconf, automake, flex, git-core, wget, g++, libc-dbg, bison, indent, pkgconfig</p>
<p>You need to install the correspondent packages in advance.</p>
<div class="highlight-python"><pre>$ sudo apt-get install git-core (in ubuntu/debian)</pre>
</div>
<p>or</p>
<div class="highlight-python"><pre>$ sudo yum install git (in fedora)</pre>
</div>
</div>
<div class="section" id="building-ns-3-dce-and-dce-quagga">
<h3>Building ns-3, DCE, and DCE-Quagga<a class="headerlink" href="#building-ns-3-dce-and-dce-quagga" title="Permalink to this headline">¶</a></h3>
<p>First you need to download NS-3 DCE using mercurial:</p>
<div class="highlight-python"><pre>$ mkdir test_build_ns3_dce
$ cd test_build_ns3_dce
$ hg clone http://code.nsnam.org/furbani/ns-3-dce</pre>
</div>
<p>then build ns-3-dce:</p>
<div class="highlight-python"><pre>$ ns-3-dce/utils/clone_and_compile_ns3_dce.sh -k</pre>
</div>
<p>Note that &#8220;-k&#8221; requires the build of ns-3-linux, which supports Linux
native stack direct code execution with quagga. This is highly
recommended at this moment (2012/04/20) so that Quagga runs
successfully.</p>
<p>For more information about ns-3-dce core, please refer the <a class="reference external" href="http://www-sop.inria.fr/members/Frederic.Urbani/ns3dceccnx/getting-started.html#building-ns-3-and-dce">DCE manual</a>.</p>
<p>After DCE is installed successfully, download ns-3-dce-quagga.</p>
<div class="highlight-python"><pre>$ cd test_build_ns3_dce
$ hg clone http://code.nsnam.org/thehajime/ns-3-dce-quagga</pre>
</div>
<p>You can build ns-3-dce-quagga as following:</p>
<div class="highlight-python"><pre>$ cd ns-3-dce-quagga
$ ./utils/dce_build.sh -k
...
Launch NS3QUAGGATEST-DCE
PASS dce-quagga 16.310ms
  PASS Check that process "ospfd (ns3)" completes correctly. 2.010ms
  PASS Check that process "bgpd (ns3)" completes correctly. 1.180ms
  PASS Check that process "radvd (kernel)" completes correctly. 2.000ms
  PASS Check that process "ripd (kernel)" completes correctly. 1.270ms
  PASS Check that process "ripngd (kernel)" completes correctly. 1.200ms
  PASS Check that process "ospfd (kernel)" completes correctly. 3.500ms
  PASS Check that process "ospf6d (kernel)" completes correctly. 1.490ms
  PASS Check that process "bgpd (kernel)" completes correctly. 1.740ms
  PASS Check that process "bgpd_v6 (kernel)" completes correctly. 1.920ms</pre>
</div>
<p>You can see the above PASSed test if everything goes fine. Congrats!</p>
</div>
<div class="section" id="setting-environment">
<h3>Setting Environment<a class="headerlink" href="#setting-environment" title="Permalink to this headline">¶</a></h3>
<p>Call the setenv.sh script to correctly setup the environment variables (i.e., PATH, LD_LIBRARY_PATH and PKG_CONFIG_PATH)</p>
<div class="highlight-python"><pre>$ source ns-3-dce/utils/setenv.sh</pre>
</div>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="section" id="basic">
<h4>Basic<a class="headerlink" href="#basic" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><pre>$ cd ns-3-dce-quagga
$ ./build/bin/dce-zebra-simple</pre>
</div>
<p>if everything goes fine, you would see the file &#8220;routes.log&#8221; in the current directory as follows.
The routes &#8220;10.1.0.0/24&#8221; and &#8220;10.2.0.0/24&#8221; was announced by ospfd accordingly.</p>
<div class="highlight-python"><pre>Time: 70s
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
127.0.0.0       0.0.0.0         255.0.0.0       U     0      -      -   0
10.1.1.0        0.0.0.0         255.255.255.0   U     0      -      -   1
10.2.1.0        0.0.0.0         255.255.255.0   U     0      -      -   2
10.1.0.0        10.2.1.1        255.255.255.0   UGS   20     -      -   2
10.2.0.0        10.1.1.1        255.255.255.0   UGS   20     -      -   1</pre>
</div>
</div>
<div class="section" id="ospf">
<h4>OSPF<a class="headerlink" href="#ospf" title="Permalink to this headline">¶</a></h4>
<p>Another example of OSPF is generating pcap file.</p>
<div class="highlight-python"><pre>$ cd ns-3-dce-quagga
$ ./build/bin/dce-quagga-ospfd</pre>
</div>
<p>You would see the following parsed output by tcpdump.</p>
<div class="highlight-python"><pre>$ tcpdump -r dce-quagga-ospfd-0-0.pcap -n -vvv
 :
 (snip)
09:00:45.106325 IP (tos 0x0, ttl 1, id 0, offset 0, flags [none], proto OSPF (89), length 72, bad cksum 0 (-&gt;a55b)!)
    10.0.0.2 &gt; 10.0.0.1: OSPFv2, Database Description, length 52
        Router-ID 10.0.0.2, Backbone Area, Authentication Type: none (0)
        Options [External], DD Flags [Master], MTU: 65535, Sequence: 0x4b3d3b2e
          Advertising Router 10.0.0.2, seq 0x80000002, age 0s, length 16
            Router LSA (1), LSA-ID: 10.0.0.2
            Options: [External]</pre>
</div>
</div>
<div class="section" id="ospf-with-ns-3-linux">
<h4>OSPF with ns-3-linux<a class="headerlink" href="#ospf-with-ns-3-linux" title="Permalink to this headline">¶</a></h4>
<p>The final example of OSPF is using Linux kernel stack via DCE.</p>
<div class="highlight-python"><pre>$ cd ns-3-dce-quagga
$ ./build/bin/dce-quagga-ospfd --netStack=linux</pre>
</div>
<p>then, you would see the following parsed output by tcpdump.</p>
<div class="highlight-python"><pre>$ tcpdump -r dce-quagga-ospfd-0-0.pcap -n -vvv
 :
 (snip)
09:00:45.106325 IP (tos 0xc0, ttl 1, id 15116, offset 0, flags [none], proto OSPF (89), length 72)
    10.0.0.2 &gt; 10.0.0.1: OSPFv2, Database Description, length 52
        Router-ID 10.0.0.2, Backbone Area, Authentication Type: none (0)
        Options [External], DD Flags [Master], MTU: 1500, Sequence: 0x4b3d3b2e
          Advertising Router 10.0.0.2, seq 0x80000002, age 0s, length 16
            Router LSA (1), LSA-ID: 10.0.0.2
            Options: [External]</pre>
</div>
</div>
</div>
<div class="section" id="configuration-manual">
<h3>Configuration Manual<a class="headerlink" href="#configuration-manual" title="Permalink to this headline">¶</a></h3>
<p>In order to utilize quagga protocols in ns-3, users need to define in the scenario via ns3::QuaggaHelper.</p>
<div class="highlight-python"><pre>#include "ns3/quagga-helper.h"

int main (int argc, char *argv[])
{
  QuaggaHelper quagga;
  quagga.EnableOspf (node, "10.0.0.0/8");
  quagga.EnableOspfDebug (node);
  quagga.EnableZebraDebug (node);
  quagga.Install (node);
}</pre>
</div>
</div>
</div>
<div class="section" id="modifying-dce-quagga">
<h2>Modifying DCE Quagga<a class="headerlink" href="#modifying-dce-quagga" title="Permalink to this headline">¶</a></h2>
<div class="section" id="customizing-helper">
<h3>Customizing Helper<a class="headerlink" href="#customizing-helper" title="Permalink to this headline">¶</a></h3>
<p>At this moment, only a limited configuration of Quagga is implemented
in the QuaggaHelper. For example, if you wanna configure the &#8220;cost&#8221;
parameter of OSPF link, you do have to extend QuaggaHelper
(quagga-helper.cc) to generate the following configuration for example.</p>
<div class="highlight-python"><pre>interface sim0
  ip ospf cost 20
!</pre>
</div>
</div>
<div class="section" id="customizing-binary">
<h3>Customizing Binary<a class="headerlink" href="#customizing-binary" title="Permalink to this headline">¶</a></h3>
<p>If you wanna extend the protocol by modifying the source code of
Quagga, your extended binary should be located at the directory
&#8220;ns-3-dce/build/bin_dce&#8221;.</p>
</div>
</div>
<div class="section" id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h2>
<p>(TBA)</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html#document-index">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-getting-started">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#current-status-2012-4-23">Current Status (2012/4/23)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#getting-started">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#prerequisite">Prerequisite</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#building-ns-3-dce-and-dce-quagga">Building ns-3, DCE, and DCE-Quagga</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#setting-environment">Setting Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#basic">Basic</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ospf">OSPF</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ospf-with-ns-3-linux">OSPF with ns-3-linux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configuration-manual">Configuration Manual</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#modifying-dce-quagga">Modifying DCE Quagga</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#customizing-helper">Customizing Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#customizing-binary">Customizing Binary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#faq">FAQ</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">NS3 DCE Quagga  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, NICT.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>